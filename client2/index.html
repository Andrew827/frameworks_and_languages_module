<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.min.css">
  <title>Your Client Title</title>
</head>

<body>
  <nav class="navbar has-shadow is-white">
    <div class="navbar-brand">
      <a class="navbar-item">
        <img src="/assets/recycling-symbol.webp" alt="site logo" style="max-height: 70px" class="py-2 px-2">
      </a>
      <button @click="toggleMenu" class="navbar-burger">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>

    <div class="navbar-menu" :class="{ 'is-active': isMenuOpen }">
      <div class="navbar-end">
        <a class="navbar-item">My Account</a>
        <a class="navbar-item">Help</a>
        <a class="navbar-item">About us</a>
      </div>
    </div>
  </nav>

  <section class="section">
    <div class="container">
      <div class="columns">
        <div class="column">
          <div class="comment-box">
            <form id="myForm" class="myForm" onsubmit="return postForm(event);">
              <div class="field">
                <label class="label">Name</label>
                <div class="control">
                  <input id="user_id" class="input is-rounded" type="text" :placeholder="'e.g. Andrew Wright'" />
                </div>
              </div>

              <div class="field">
                <label class="label">Lat</label>
                <div class="control">
                  <input id="lat" class="input is-rounded" type="number" :placeholder="'e.g. 145'" />
                </div>
              </div>

              <div class="field">
                <label class="label">Lon</label>
                <div class="control">
                  <input id="lon" class="input is-rounded" type="number" :placeholder="'e.g. 145'" />
                </div>
              </div>

              <div class="field">
                <label class="label">Description</label>
                <div class="control">
                  <input id="description" class="input is-rounded" type="text" :placeholder="'e.g. white'" />
                </div>
              </div>

              <div class="field">
                <label class="label">Keywords</label>
                <div class="control">
                  <input id="keywords" class="input is-rounded" type="text" :placeholder="'e.g. hammer'" />
                </div>
              </div>

              <div class="field">
                <div class="control">
                  <button type="submit" class="button is-rounded">Add Item</button>
                </div>
              </div>
            </form>
          </div>
        </div>
        <div class="column">
        </div>
      </div>
    </div>
  </section>

  <div class="posted-items section">
    <h2 class="title is-3">Posted Items</h2>
    <div id="postedItemsContainer" class="columns is-multiline">
      <!-- Display posted items here -->
    </div>
    <footer class="footer">
      <div class="content has-text-centered">
        <p>
          <strong>FreeCycle</strong> by <a href="https://jgthms.com">Andrew Wright</a>. Client developed in
          <a href="https://vuejs.org/"> Vue.js</a> and
          <a href="https://bulma.io/"> Bulma</a>.
        </p>
      </div>
    </footer>
  </div>

  <div class="container">
    <h1 class="title">Your Client Title</h1>
    <button id="fetchButton">Fetch Hello from Server</button>
    <p id="result"></p>
  </div>

  <script>
    const serverUrl = 'https://friendly-capybara-7j9g4x7qgg6fp5xq-8000.app.github.dev'; //????right??????

    function toggleMenu() {
      // do later get posting and returning working. Just paste this in from previous client
    }

    function postForm(event) {
      event.preventDefault();

      const newItem = {
        user_id: document.getElementById('user_id').value,
        lat: document.getElementById('lat').value,
        lon: document.getElementById('lon').value,
        description: document.getElementById('description').value,
        keywords: document.getElementById('keywords').value,
      };

      fetch(`${serverUrl}/item`, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(newItem),
      })
        .then(response => response.json())
        .then(json => {
          console.log('Item added successfully:', json);
          updatePostedItems(json.item);
        })
        .catch(err => console.error('Error adding item:', err));

      return false;
    }

    function updatePostedItems(item) {
  const postedItemsContainer = document.getElementById('postedItemsContainer');

  if (postedItemsContainer.children.length % 3 === 0) {
    const newColumn = document.createElement('div');
    newColumn.classList.add('column');
    postedItemsContainer.appendChild(newColumn);
  }

  if (item) {
    const itemCard = document.createElement('div');
    itemCard.classList.add('card');
    itemCard.innerHTML = `<div class="card-content">
                            <p>ID: ${item.id}</p>
                            <p>User ID: ${item.user_id}</p>
                            <p>Latitude: ${item.lat}</p>
                            <p>Longitude: ${item.lon}</p>
                            <p>Description: ${item.description}</p>
                            <p>Keywords: ${item.keywords}</p>
                          </div>`;
    const lastColumn = postedItemsContainer.lastElementChild;
    lastColumn.appendChild(itemCard);
  } else {
    console.error('Error adding item: Received invalid data from the server');
  }
}
    document.getElementById('fetchButton').addEventListener('click', () => {
      fetch(`${serverUrl}/hello`)
        .then(response => response.text())
        .then(data => {
          document.getElementById('result').innerText = data;
        })
        .catch(error => console.error('Error fetching data:', error));
    });
  </script>
  <script src="scripts.js"></script>
</body>

</html>